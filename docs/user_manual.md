# lchliebedich 用户手册

## 目录

1. [简介](#简介)
2. [安装与配置](#安装与配置)
3. [快速开始](#快速开始)
4. [功能详解](#功能详解)
5. [高级功能](#高级功能)
6. [故障排除](#故障排除)
7. [常见问题](#常见问题)
8. [附录](#附录)

## 简介

lchliebedich 是一个功能强大的QQ机器人词库管理工具，基于OneBot V11协议开发。它提供了现代化的图形界面，支持词库的导入、编辑、管理，以及实时的消息监控和统计分析功能。

### 主要特性

- **词库管理**: 支持多种格式的词库导入导出
- **伪代码系统**: 丰富的伪代码功能，让机器人回复更智能
- **实时监控**: 查看消息日志和连接状态
- **统计分析**: 详细的使用统计和图表分析
- **现代化界面**: 基于PyQt5的美观界面
- **跨平台支持**: 支持Windows、macOS和Linux

### 系统要求

- Python 3.7 或更高版本
- PyQt5 5.12 或更高版本
- 至少 100MB 可用磁盘空间
- 网络连接（用于OneBot通信）

## 安装与配置

### 安装步骤

1. **克隆项目**
   ```bash
   git clone https://github.com/Tavre/lchliebedich.git
   cd lchliebedich
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行程序**
   ```bash
   python main.py
   ```

### 首次配置

1. **OneBot设置**
   - 打开"工具" → "配置管理"
   - 在"OneBot设置"标签页中配置连接信息
   - 填入正确的服务器地址和端口
   - 点击"测试连接"验证配置

2. **词库路径设置**
   - 在"基本设置"中设置词库文件存储路径
   - 建议使用专门的文件夹存储词库

3. **日志设置**
   - 根据需要调整日志级别
   - 设置日志文件保存位置

## 快速开始

### 第一次使用

1. **启动程序**
   - 运行 `python main.py`
   - 程序会自动检测并选择合适的界面模式

2. **配置OneBot连接**
   - 确保您的QQ机器人框架（如go-cqhttp）已正确配置并运行
   - 在配置管理中填入连接信息
   - 测试连接确保正常

3. **导入词库**
   - 点击"文件" → "导入词库"
   - 选择词库文件（支持.txt格式）
   - 词库会自动解析并加载

4. **开始使用**
   - 在消息页面可以看到实时的消息日志
   - 在统计页面查看使用情况

### 界面介绍

#### 主界面布局

- **菜单栏**: 包含文件、编辑、工具、视图、帮助等菜单
- **标签页**: 概览、词库、消息、统计四个主要页面
- **状态栏**: 显示连接状态、词库信息等

#### 各页面功能

1. **概览页面**
   - 显示系统状态概览
   - OneBot连接状态
   - 词库基本信息
   - 快速操作按钮

2. **词库页面**
   - 词库内容浏览
   - 词库编辑功能
   - 搜索和过滤

3. **消息页面**
   - 实时消息日志
   - 消息过滤和搜索
   - 日志导出功能

4. **统计页面**
   - 使用统计图表
   - 性能监控
   - 数据分析

## 功能详解

### 词库管理

#### 词库格式

lchliebedich 支持特定格式的词库文件：

```
# 这是注释行，以#开头
问题1
答案1
答案2

问题2
答案1
```

#### 伪代码功能

词库支持丰富的伪代码，让机器人回复更加智能：

- `%用户名%` - 获取发送者昵称
- `%群名%` - 获取群聊名称
- `%时间%` - 获取当前时间
- `%日期%` - 获取当前日期
- `%随机数%` - 生成随机数
- `%随机数(1,100)%` - 生成指定范围的随机数
- `%天气%` - 获取天气信息（需要配置API）

#### 词库操作

**导入词库**
1. 点击"文件" → "导入词库"
2. 选择词库文件
3. 系统自动解析并加载
4. 检查导入结果

**编辑词库**
1. 在词库页面选择要编辑的条目
2. 双击进行编辑
3. 使用工具栏按钮添加、删除条目
4. 保存更改

**导出词库**
1. 点击"文件" → "导出词库"
2. 选择导出格式（TXT、JSON、CSV）
3. 选择保存位置
4. 确认导出

### OneBot连接

#### 连接配置

1. **基本设置**
   - 服务器地址：OneBot服务器的IP地址
   - 端口号：OneBot服务器的端口
   - 访问令牌：如果设置了access_token

2. **高级设置**
   - 心跳间隔：保持连接的心跳频率
   - 重连间隔：连接断开后的重连间隔
   - 超时设置：连接和请求的超时时间

#### 连接状态

- **已连接**：绿色指示，正常通信
- **连接中**：黄色指示，正在建立连接
- **已断开**：红色指示，连接失败或断开

### 消息监控

#### 实时日志

- 显示所有收发的消息
- 支持消息类型过滤
- 支持关键词搜索
- 支持时间范围过滤

#### 日志管理

- **清空日志**：清除当前显示的日志
- **保存日志**：将日志保存到文件
- **自动滚动**：自动滚动到最新消息
- **消息计数**：显示消息总数

### 统计分析

#### 基本统计

- 消息总数
- 活跃用户数
- 群聊数量
- 词库命中率

#### 图表分析

- **消息趋势图**：显示消息数量随时间的变化
- **用户活跃度**：显示最活跃的用户
- **群聊活跃度**：显示最活跃的群聊
- **词库使用情况**：显示最常用的词库条目

#### 性能监控

- CPU使用率
- 内存使用情况
- 网络流量
- 响应时间

## 高级功能

### 批量操作

#### 批量导入

1. 选择多个词库文件
2. 系统依次处理每个文件
3. 显示导入进度和结果
4. 处理导入冲突

#### 批量编辑

1. 使用查找替换功能
2. 支持正则表达式
3. 预览更改结果
4. 批量应用更改

#### 批量删除

1. 选择多个词库条目
2. 确认删除操作
3. 支持撤销操作

### 自定义配置

#### 界面自定义

- 主题选择
- 字体设置
- 颜色配置
- 布局调整

#### 功能配置

- 自动保存间隔
- 日志保留时间
- 缓存大小限制
- 性能优化选项

### 插件系统

#### 插件开发

1. 创建插件文件
2. 实现插件接口
3. 注册插件功能
4. 测试插件功能

#### 插件管理

- 启用/禁用插件
- 插件配置
- 插件更新
- 插件卸载

## 故障排除

### 常见问题

#### 连接问题

**问题**: 无法连接到OneBot服务器

**解决方案**:
1. 检查OneBot服务器是否正在运行
2. 验证IP地址和端口号
3. 检查防火墙设置
4. 查看OneBot服务器日志

**问题**: 连接频繁断开

**解决方案**:
1. 增加心跳间隔时间
2. 检查网络稳定性
3. 更新OneBot服务器版本
4. 调整超时设置

#### 词库问题

**问题**: 词库导入失败

**解决方案**:
1. 检查文件格式和编码（推荐UTF-8）
2. 确认文件没有被占用
3. 检查词库内容格式
4. 查看错误日志

**问题**: 机器人不回复消息

**解决方案**:
1. 检查词库是否正确加载
2. 验证触发词匹配规则
3. 确认机器人有发言权限
4. 查看消息日志中的错误信息

#### 性能问题

**问题**: 程序运行缓慢

**解决方案**:
1. 减少词库大小
2. 关闭不必要的日志记录
3. 增加系统内存
4. 使用SSD硬盘
5. 调整性能设置

**问题**: 内存占用过高

**解决方案**:
1. 定期重启程序
2. 清理日志文件
3. 优化词库结构
4. 调整缓存设置

### 错误代码

| 错误代码 | 描述 | 解决方案 |
|---------|------|----------|
| E001 | 连接超时 | 检查网络连接和服务器状态 |
| E002 | 认证失败 | 检查访问令牌配置 |
| E003 | 词库格式错误 | 检查词库文件格式 |
| E004 | 文件读取失败 | 检查文件权限和路径 |
| E005 | 内存不足 | 释放内存或增加系统内存 |

### 日志分析

#### 日志级别

- **DEBUG**: 详细的调试信息
- **INFO**: 一般信息
- **WARNING**: 警告信息
- **ERROR**: 错误信息
- **CRITICAL**: 严重错误

#### 日志位置

- Windows: `%APPDATA%\lchliebedich\logs\`
- macOS: `~/Library/Application Support/lchliebedich/logs/`
- Linux: `~/.local/share/lchliebedich/logs/`

## 常见问题

### Q: 如何备份词库数据？

**A**: 
1. 使用"文件" → "导出词库"功能
2. 选择合适的导出格式
3. 定期备份导出的文件
4. 也可以直接备份词库文件夹

### Q: 如何提高机器人响应速度？

**A**:
1. 优化词库结构，减少冗余条目
2. 使用更快的硬盘（SSD）
3. 增加系统内存
4. 调整性能设置
5. 关闭不必要的功能

### Q: 如何自定义伪代码？

**A**:
1. 在配置中添加自定义伪代码
2. 编写伪代码处理函数
3. 注册到伪代码系统
4. 测试自定义功能

### Q: 如何处理特殊字符？

**A**:
1. 确保文件使用UTF-8编码
2. 在词库中正确转义特殊字符
3. 使用Unicode字符表示
4. 测试特殊字符显示

### Q: 如何更新程序？

**A**:
1. 备份当前配置和词库
2. 下载最新版本
3. 替换程序文件
4. 恢复配置和词库
5. 测试功能正常

## 附录

### 快捷键列表

#### 全局快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+I | 导入词库 |
| Ctrl+E | 导出词库 |
| F5 | 重载词库 |
| Ctrl+T | 测试连接 |
| Ctrl+W | 词库管理 |
| Ctrl+, | 配置管理 |
| F11 | 全屏切换 |
| F1 | 关于 |
| Ctrl+F1 | 帮助文档 |

#### 页面切换

| 快捷键 | 页面 |
|--------|------|
| Ctrl+1 | 概览页面 |
| Ctrl+2 | 词库页面 |
| Ctrl+3 | 消息页面 |
| Ctrl+4 | 统计页面 |

#### 编辑快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+F | 查找 |
| Ctrl+H | 查找替换 |
| Ctrl+A | 全选 |
| Ctrl+C | 复制 |
| Ctrl+V | 粘贴 |
| Ctrl+Z | 撤销 |
| Ctrl+Y | 重做 |

### 配置文件格式

#### config.yaml 示例

```yaml
# OneBot配置
onebot:
  host: "127.0.0.1"
  port: 8080
  access_token: ""
  heartbeat_interval: 30
  reconnect_interval: 5
  timeout: 10

# 词库配置
wordlib:
  path: "./wordlib"
  auto_reload: true
  backup_enabled: true
  backup_interval: 3600

# 日志配置
logging:
  level: "INFO"
  file_path: "./logs"
  max_size: 10485760  # 10MB
  backup_count: 5

# 界面配置
ui:
  theme: "default"
  font_size: 12
  auto_save_interval: 300
```

### API接口文档

#### 基本接口

**获取词库列表**
```
GET /api/wordlib/list
```

**导入词库**
```
POST /api/wordlib/import
Content-Type: multipart/form-data
```

**获取统计信息**
```
GET /api/stats/summary
```

#### 响应格式

```json
{
  "code": 200,
  "message": "success",
  "data": {
    // 响应数据
  }
}
```

### 更新日志

#### v1.0.0 (2024-01-20)

- 初始版本发布
- 基本词库管理功能
- OneBot连接支持
- PyQt5界面

#### v1.1.0 (2024-02-15)

- 添加统计分析功能
- 改进界面设计
- 修复已知问题
- 性能优化

#### v1.2.0 (2024-03-10)

- 添加帮助文档系统
- 增强词库编辑功能
- 添加批量操作
- 改进错误处理

---

**技术支持**: 如果您在使用过程中遇到问题，请访问 [GitHub Issues](https://github.com/Tavre/lchliebedich/issues) 提交问题报告。

**贡献代码**: 欢迎提交Pull Request来改进项目，请先阅读贡献指南。

**许可证**: 本项目采用MIT许可证，详见LICENSE文件。